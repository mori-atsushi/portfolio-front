---
title: 'Navigation Componentのいい感じのアニメーションを検討する【サンプルアプリあり】'
description: 'Navigation Componentの登場により、画面遷移をFragmentベースで行う例が増えてきたように思います。\n\nFragmentで画面遷移をさせることで、toolbarやbottom navigation view等の共通のUIを表示し続けられるようになったり、activityでの画面遷移よりパフォーマンスがよかったり、いくつかの利点があります。\n\n一方で、activityでの画面遷移とは違い、navigation利用時は遷移時にデフォルトのアニメーションがつきません。\n\nそこで、今回はいくつかの遷移アニメーションの例を提示したいと思います。'
pubDate: '2020-08-10T10:00:00.000Z'
ogpImage: '../../assets/2020-08-10-ogp.png'
---

[Navigation component](https://developer.android.com/guide/navigation/navigation-getting-started)の登場により、画面遷移をFragmentベースで行う例が増えてきたように思います。

Fragmentで画面遷移をさせることで、toolbarやbottom navigation view等の共通のUIを表示し続けられるようになったり、activityでの画面遷移よりパフォーマンスがよかったり、いくつかの利点があります。

一方で、activityでの画面遷移とは違い、navigation利用時は遷移時にデフォルトのアニメーションがつきません。

そこで、今回はいくつかの遷移アニメーションの例を提示したいと思います。

## カタログアプリ
今回提示する例は一つのカタログアプリとして見れるようにし、githubで公開しています。

[GitHub - Mori-Atsushi/android-nav-anim-catlog](https://github.com/Mori-Atsushi/android-nav-anim-catlog)

## アニメーションの作り方
アニメーションの定義はさほど難しくありません。

以下の4つのアニメーションを定義する必要があります。

* 画面遷移により表示されるときのアニメーション -> enterAnim
* 画面遷移により非表示になるときのアニメーション -> exitAnim
* 戻るアクションにより表示されるときのアニンメーション -> popEnterAnim
* 戻るアクションにより非表示になるときのアニメーション -> popExitAnim

それぞれを、[ここ](https://developer.android.com/guide/topics/resources/animation-resource#Property)を参考にしながらxmlにて定義します。

例えば、fade inだとこんな感じです。

```xml
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <alpha
        android:interpolator="@android:anim/linear_interpolator"
        android:duration="@integer/config_navAnimTime"
        android:fromAlpha="0.0"
        android:toAlpha="1.0"/>
</set>
```

それを先程の4つ分作り、navigationのactionにsetします。

```xml
<fragment
    android:id="@+id/listFragment"
    android:name="com.example.nav_anim_catalog.list.ListFragment"
    android:label="Navigation Animation Catalog">
    <action
        android:id="@+id/to_sample_fade"
        app:destination="@id/sampleFragment"
        app:enterAnim="@anim/nav_default_enter_anim"
        app:exitAnim="@anim/nav_default_exit_anim"
        app:popEnterAnim="@anim/nav_default_pop_enter_anim"
        app:popExitAnim="@anim/nav_default_pop_exit_anim" />
</fragment>
```

詳しくは[こちら](https://developer.android.com/guide/navigation/navigation-animate-transitions)をごらんください。

## 各アニメーションについて
8種類のアニメーションを定義しました。それぞれについてさっと見ていこうと思います。

一部Activityの背景を白か黒に変化させています。

また、[FragmentContainerView](https://developer.android.com/reference/androidx/fragment/app/FragmentContainerView)を使っていることに注意してください。

FrameLayoutだとアニメーション時のFragmentの重なりがおかしくなる可能性があります。

各xmlはgithubを参考にしてください。

### Fade In / Fade Out

<img src="/images/2020-08-10-1-fade.gif" width="320px" />


以下の名前でデフォルトで用意されているアニメーションです。

* @anim/nav_default_enter_anim
* @anim/nav_default_exit_anim
* @anim/nav_default_pop_enter_anim
* @anim/nav_default_pop_exit_anim

一番シンプルかつ、googleのアプリケーションでもよく使われています。

duration等は調整しても良いと思います。

### Slide In / Slide Out

<img src="/images/2020-08-10-2-slide.gif" width="320px" />


* [@anim/nav_slide_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_slide_enter_anim.xml)
* [@anim/nav_slide_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_slide_exit_anim.xml)
* [@anim/nav_slide_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_slide_pop_enter_anim.xml)
* [@anim/nav_slide_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_slide_pop_exit_anim.xml)

横にスライドしつつフェードインします。

PlayStoreでも使われていますね。

### Zoom In / Zoom Out

<img src="/images/2020-08-10-3-zoom.gif" width="320px" />


* [@anim/nav_zoom_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_zoom_enter_anim.xml)
* [@anim/nav_zoom_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_zoom_exit_anim.xml)
* [@anim/nav_zoom_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_zoom_pop_enter_anim.xml)
* [@anim/nav_zoom_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_zoom_pop_exit_anim.xml)

Android 10のPixel等にてActivityの画面遷移に使われているものを真似してみました。

ズームインしながらフェードインします。

### Slide Up / Slide Down
<img src="/images/2020-08-10-4-up.gif" width="320px" />


* [@anim/nav_up_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_up_enter_anim.xml)
* [@anim/nav_up_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_up_exit_anim.xml)
* [@anim/nav_up_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_up_pop_enter_anim.xml)
* [@anim/nav_up_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_up_pop_exit_anim.xml)

よくある下からスライドしてくるアニメーションです。

Toolbarが固定だと少し違和感があるかもしれません。

exitAnimではenterAnimの完了を待つため、動作のないanimationが定義されています。

### Like iOS
<img src="/images/2020-08-10-5-ios.gif" width="320px" />


* [@anim/nav_ios_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_ios_enter_anim.xml)
* [@anim/nav_ios_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_ios_exit_anim.xml)
* [@anim/nav_ios_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_ios_pop_enter_anim.xml)
* [@anim/nav_ios_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_ios_pop_exit_anim.xml)

iOSのnavigationに似たアニメーションを作ってみました。

手前のviewは横からスライドし、後ろのviewは少しだけスライドしフェードアウトします。

### Like Twitter App
<img src="/images/2020-08-10-6-twitter.gif" width="320px" />


* [@anim/nav_twitter_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_twitter_enter_anim.xml)
* [@anim/nav_twitter_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_twitter_exit_anim.xml)
* [@anim/nav_twitter_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_twitter_pop_enter_anim.xml)
* [@anim/nav_twitter_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_twitter_pop_exit_anim.xml)

TwitterのAndroidアプリに似た画面遷移です。

Like iOSとよく似ていますが、後ろのviewが小さくなりつつフェードアウトします。

こちらもToolbarが固定だと少し違和感がありそうです。

### Rotate
<img src="/images/2020-08-10-7-rotate.gif" width="320px" />

* [@anim/nav_rotate_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_rotate_enter_anim.xml)
* [@anim/nav_rotate_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_rotate_exit_anim.xml)
* [@anim/nav_rotate_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_rotate_pop_enter_anim.xml)
* [@anim/nav_rotate_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_rotate_pop_exit_anim.xml)

一応回転もできるので試してみたのんですが、使うことはなさそうです。

### Dynamic
<img src="/images/2020-08-10-8-dynamic.gif" width="320px" />

* [@anim/nav_dynamic_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_dynamic_enter_anim.xml)
* [@anim/nav_dynamic_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_dynamic_exit_anim.xml)
* [@anim/nav_dynamic_pop_enter_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_dynamic_pop_enter_anim.xml)
* [@anim/nav_dynamic_pop_exit_anim](https://github.com/Mori-Atsushi/android-nav-anim-catlog/blob/master/app/src/main/res/anim/nav_dynamic_pop_exit_anim.xml)

少し派手なアニメーションも用意してみました。

しかし、頻発する画面遷移はシンプルなアニメーションのほうが好まれると思います。

## まとめ
今回、navigation用のいろいろなアニメーションを作ってみました。

単純なxmlですが、工夫すればより複雑なアニメーションも作れます。

個人的にはZoom In / Zoom OutかLike iOSが使いやすいなと感じました。

もしよかったら参考にしてみてください。
